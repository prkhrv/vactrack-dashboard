"use strict";(self.webpackChunk_coreui_coreui_pro_react_admin_template=self.webpackChunk_coreui_coreui_pro_react_admin_template||[]).push([[1339],{33720:(e,s,i)=>{i.r(s),i.d(s,{default:()=>u});var l=i(65043),c=(i(98139),i(37924)),r=i(42315),a=i(70579);const n=e=>{let{id:s,permissionsData:i,setUpdatedPermissions:r}=e;const[n,t]=(0,l.useState)(i),o=(e,i)=>{const l=n.map((s=>s.name===e?"read"===i?{...s,[i]:!s[i],create:!1,edit:!1,delete:!1,view_all:!1,modify_all:!1}:{...s,[i]:!s[i]}:s));t(l),r(s,l)};return(0,a.jsxs)(c._v,{bordered:!0,borderColor:"dark",striped:!0,children:[(0,a.jsx)(c.wV,{children:(0,a.jsxs)(c.YI,{children:[(0,a.jsx)(c.$s,{scope:"col",children:"Module"}),(0,a.jsx)(c.$s,{scope:"col",children:"Read"}),(0,a.jsx)(c.$s,{scope:"col",children:"Create"}),(0,a.jsx)(c.$s,{scope:"col",children:"Edit"}),(0,a.jsx)(c.$s,{scope:"col",children:"Delete"}),(0,a.jsx)(c.$s,{scope:"col",children:"View All"}),(0,a.jsx)(c.$s,{scope:"col",children:"Modify All"})]})}),(0,a.jsx)(c.jS,{children:n.map((e=>(0,a.jsxs)(c.YI,{children:[(0,a.jsx)(c.cC,{children:e.name}),(0,a.jsx)(c.cC,{children:(0,a.jsx)("input",{type:"checkbox",checked:e.read,onChange:()=>o(e.name,"read")})}),(0,a.jsx)(c.cC,{children:(0,a.jsx)("input",{type:"checkbox",checked:e.create,onChange:()=>o(e.name,"create")})}),(0,a.jsx)(c.cC,{children:(0,a.jsx)("input",{type:"checkbox",checked:e.edit,onChange:()=>o(e.name,"edit")})}),(0,a.jsx)(c.cC,{children:(0,a.jsx)("input",{type:"checkbox",checked:e.delete,onChange:()=>o(e.name,"delete")})}),(0,a.jsx)(c.cC,{children:(0,a.jsx)("input",{type:"checkbox",checked:e.view_all,onChange:()=>o(e.name,"view_all")})}),(0,a.jsx)(c.cC,{children:(0,a.jsx)("input",{type:"checkbox",checked:e.modify_all,onChange:()=>o(e.name,"modify_all")})})]},e.name)))})]})};var t=i(63401),o=i(28131),d=i(6145),h=i(69833);const m=e=>{let{show:s,handleClose:i}=e;const[n,o]=(0,l.useState)(!1),[d,h]=(0,l.useState)(""),[m,u]=(0,l.useState)(!1),x=e=>{/^[a-zA-Z\s]{3,}$/.test(e)?u(!0):u(!1)};return(0,a.jsxs)(c.zS,{visible:s,onClose:()=>i(),"aria-labelledby":"AddGroupModal",size:"lg",children:[(0,a.jsx)(c.E4,{closeButton:!0,children:(0,a.jsx)(c.lb,{children:"Add Group"})}),(0,a.jsx)(c.Tc,{children:(0,a.jsx)(c.qI,{children:(0,a.jsxs)(c.BG,{className:"mb-3",children:[(0,a.jsx)(c.sk,{id:"inputGroup-sizing-default",children:"Name"}),(0,a.jsx)(c.OG,{id:"groupName",placeholder:"Enter name",value:d,valid:m,invalid:!m,onChange:e=>{h(e.target.value),x(e.target.value)},feedbackValid:"Looks good!",feedbackInvalid:"Please enter a valid name",required:!0})]})})}),(0,a.jsxs)(c.If,{children:[(0,a.jsx)(c.Q_,{color:"secondary",onClick:i,children:"Close"}),(0,a.jsx)(c.Q_,{color:"primary",onClick:async e=>{if(m){const e={name:d},s=await(0,r.iF)("/groups",e);console.log(s),201!==s.statusCode?t.oR.error("Cannot Add Group"):(t.oR.success("Group Added Successfully"),i(!0))}else t.oR.error("Please fill all the fields correctly")},children:"Add Group"})]})]})},u=()=>{const[e,s]=(0,l.useState)([]),[i,u]=(0,l.useState)(!1),[x,p]=(0,l.useState)(!1),[j,_]=(0,l.useState)([]),g=o.A.getPermissions().find((e=>"Groups"===e.name)),v=!!g&&g.create;async function y(){u(!0);const e=await(0,r.iF)("/groups/fetch");return 200!==e.statusCode?[]:e.data}(0,l.useEffect)((()=>{y().then((e=>{_(e),u(!1)}))}),[]);const C=(e,s)=>{_((i=>i.map((i=>i.permissions[0]._id==e?{...i,permissions:[{...i.permissions[0],modules:s}]}:i))))};return(0,a.jsxs)("div",{children:[(0,a.jsx)(m,{show:x,handleClose:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&y().then((e=>{_(e),u(!1)})),p(!1)}}),(0,a.jsx)(c.E$,{className:"mb",children:(0,a.jsxs)(c.W6,{children:[(0,a.jsxs)(c.sK,{children:[(0,a.jsx)(c.UF,{sm:5,children:(0,a.jsx)("div",{children:(0,a.jsx)("h5",{children:(0,a.jsx)("strong",{children:"Groups"})})})}),(0,a.jsx)(c.UF,{sm:7,className:"d-none d-md-block",children:v&&(0,a.jsxs)(c.Q_,{color:"primary",className:"float-end",style:{marginRight:"10px"},onClick:()=>{p(!x)},children:[(0,a.jsx)(d.A,{icon:h.x,className:"text-light"}),(0,a.jsx)("span",{style:{marginLeft:"5px",color:"white"},children:"Add Group"})]})})]}),(0,a.jsx)(c.Pd,{activePage:1,cleaner:!0,clickableRows:!0,columns:[{key:"sr",label:"#",filter:!1,sorter:!1,_style:{width:"1%"}},{key:"name",_style:{width:"20%"}},{label:"Created Date",key:"created_date",_style:{width:"20%"}},{key:"show_details",label:"",_style:{width:"1%"},filter:!1,sorter:!1}],columnFilter:!0,columnSorter:!0,loading:i,items:j,itemsPerPageSelect:!0,itemsPerPage:10,pagination:!0,onFilteredItemsChange:e=>{console.log(e)},onSelectedItemsChange:e=>{console.log(e)},scopedColumns:{sr:(e,s)=>(0,a.jsx)("td",{children:s+1}),created_date:e=>{return(0,a.jsx)("td",{children:(s=e.created_date,new Date(s).toLocaleDateString(void 0,{year:"numeric",month:"long",day:"numeric"}))});var s},avatar:e=>(0,a.jsx)("td",{children:(0,a.jsx)(c.re,{src:"/images/avatars/".concat(e.avatar)})}),is_active:e=>{return(0,a.jsx)("td",{children:(0,a.jsx)("h5",{children:(0,a.jsx)(c.$X,{color:(s=e.is_active,s?"success":"danger"),children:e.is_active?"Active":"Inactive"})})});var s},show_details:i=>(0,a.jsx)("td",{className:"py-2",children:(0,a.jsx)(c.Q_,{color:"primary",variant:"outline",shape:"square",size:"sm",onClick:()=>{(i=>{const l=e.indexOf(i);let c=e.slice();-1!==l?c.splice(l,1):c=[...e,i],s(c)})(i._id)},children:e.includes(i._id)?"Hide":"Permissions"})}),details:(s,i)=>(0,a.jsx)(c.x8,{visible:e.includes(s._id),children:(0,a.jsxs)(c.W6,{className:"p-3",children:[(0,a.jsx)("p",{className:"text-muted",children:"Permissions:"}),(0,a.jsx)(n,{id:s.permissions[0]._id,permissionsData:s.permissions[0].modules,setUpdatedPermissions:C}),(0,a.jsx)("div",{className:"mt-3 d-flex justify-content-start",children:(0,a.jsx)(c.Q_,{size:"sm",color:"info",onClick:()=>(async(e,s)=>{console.log(e,s),200!==(await(0,r.iF)("/permissions/edit",{id:"".concat(e),modules:s})).statusCode?t.oR.error("Error saving permissions"):t.oR.success("Permissions saved successfully")})(s.permissions[0]._id,s.permissions[0].modules),children:"Save"})})]})})},sorterValue:{column:"status",state:"asc"},tableFilter:!0,tableProps:{className:"add-this-class",responsive:!0,striped:!0,hover:!0},tableBodyProps:{className:"align-middle"}})]})})]})}},69833:(e,s,i)=>{i.d(s,{x:()=>l});var l=["512 512","<polygon fill='var(--ci-primary-color, currentColor)' points='440 240 272 240 272 72 240 72 240 240 72 240 72 272 240 272 240 440 272 440 272 272 440 272 440 240' class='ci-primary'/>"]}}]);
//# sourceMappingURL=1339.f9a7d2a0.chunk.js.map